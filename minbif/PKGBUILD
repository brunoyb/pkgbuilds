# Contributor: totoloco <totoloco at gmail dot com>
# Contributor: AkiraYB <brunoyb at yahoo dot com dot br>

pkgname=minbif
pkgver=1.0
pkgrel=2
pkgdesc="It aims to use the libpurple library from the Pidgin project to provide an IRC-friendly instant messaging client."
arch=('i686' 'x86_64')
url="http://symlink.me/wiki/minbif"
license=('GPL')
makedepends=('cmake')
depends=('libpurple' 'libcaca')
optdepends=('xinetd: to run minbif through xinetd')
backup=(etc/minbif/minbif.conf
        etc/minbif/minbif.motd
        etc/xinetd.d/minbif)
source=('http://symlink.me/attachments/download/30/'$pkgname-$pkgver'.tar.gz'
        ${pkgname}'.rcd'
        ${pkgname}'.xinetd')
install=${pkgname}.install
md5sums=('792854533b0f653a2f70d93007e2e87a'
         '799f777f3254bd5c78597a92b0cb972a'
         'da02518644a583124d7ed839f5eab6c5')

build() {
	cd $srcdir/$pkgname-$pkgver
	make ENABLE_CACA=1 PREFIX=/usr CONF_PREFIX=/etc/minbif || return 1

	install -m755 -d $pkgdir/var/run
	install -m755 -d $pkgdir/var/lib
	install -o64 -g64 -d -m755 $pkgdir/var/run/minbif
	install -o64 -g64 -d -m770 $pkgdir/var/lib/minbif
	install -o64 -g64 -d -m770 $pkgdir/var/lib/minbif/users
	install -D -m755 $srcdir/minbif.rcd $pkgdir/etc/rc.d/minbif || return 1
	install -D -m644 $srcdir/minbif.xinetd $pkgdir/etc/xinetd.d/minbif || return 1

	make DESTDIR=$pkgdir install || return 1
}
